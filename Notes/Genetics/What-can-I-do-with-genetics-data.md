# 群体遗传学简易入门

群体遗传学描述种群间的遗传变异，并通过观测、实验和理论确定该变异如何随着时间和空间的改变而发生变化。换句话说，有多少变异存在于自然群体中，我们应该如何从起源，维持和演化角度上解释这些变异。对群体遗传学的研究能够1)帮助我们了解遗传变异的模式和趋势，2)保护濒危物种，3)更好的理解生物演化。

任何一个遗传群体都是由它所包含的各种基因型所组成的，在一个群体内某特定基因型所占的比例，就是基因型频率(genotype frequency)。基因型是每代在受精过程中由父母所具有的基因所组成，**它是描述群体遗传结构的重要参数**。在一群体内某特定基因座某一特定等位基因占该基因座等位基因总数的比率，即为等位基因频率(allel frequency),或称基因频率。**等位基因频率是决定一个群体遗传特性的基本因素**。当环境或遗传结构不变时，等位基因频率不会改变。

## 杂合度或基因多样性

杂合度时我们在自然群体最关心的一个参数，也是拿到数据集之后最容易计算的一个参数。杂合度越高意味着遗传变异越多，反之遗传变异就少。我们经常需要将观测的杂合度和哈迪-温伯格平衡(后面简称为**HWE**)下的杂合水平进行比较，如果前者远低于后者，我们就需要找到产生原因，比如说近交或自交，如果前者远高于后者，有可能说明这个群体是两个曾经隔离过的种群杂交形成。

那么如何计算杂合度呢？如果一个基因座位上只有两个等位基因(p1,p2)，跟据HWE，它的杂合度为

$$
H_E = 2p_1p_2 = 1 - p_1^2 - p_2^2
$$

如果有三个等位基因(p1,p2,p3),那么杂合度为

$$
H_E = 2p_1p_2 + 2p_1p_3 + 2p_2p_3 = 1 - p_1^2 - p_2^2 - p_3^2 = 1 \sum_{i=1}^3p_i^2
$$

以此推广，那么单个基因座位的计算公式为:

$$
H_{E} = D = 1 - \sum_{i=1}^{k}p_{i}^2
$$

这里的$p_i$表示第i个等位基因的频率。推广到多个基因座位的计算公式为

$$
1 - \frac{1}{m}\sum_{l=1}^m\sum_{i=1}^kp_i^2
$$

核酸多样性（Nucleotide diversity）是分子遗传学中衡量群体多态性的一个概念，最早由Li和Nei在1979年提。计算公示如下

![核酸多样性](https://wikimedia.org/api/rest_v1/media/math/render/svg/be2956df9d2756a4f051f2516938d4831fcd3771)

## 检查群体结构

### 分化系数：$F_{ST}$

$F_{ST}$(Fixation index,固定指数，也叫做分化系数)用来衡量因遗传结构(genetics structure)而引起的群体分化(population differentiation), 是Sewall Wright提出三个F-统计值的其中一个。目前群体遗传学最常用的统计值。

> Sewall Wright是现代群体遗传学的奠基者之一，其余两人是Ronald Fisher（费希尔）和 J.B.S. Haldane。群体遗传学好多概念就是他提出的，比如说近交系数，遗传漂变等。

如下是$F_{ST}$的几个使用场景：

**情况一**：最开始莱特提出的$F_{ST}$是描述群体中的遗传分化和一些重要进化过程（如迁移、突变和遗传漂变）之间的关系，显然一个非常大的群体即便有有几个遗传组成不太一样的个体迁移到群体中，他们受到的影响也不会太大，他们的**分化情况**也就没那么明显。因此它可以用作群体和进化遗传学的描述统计值，了解群体遗传分化情况

**情况二**：$F_{ST}$能够衡量同一个物种两个群体之间的同一个位点等位基因频率差异程度或者说相似程度。如果它比较小，说明两个物种在该基因座位上的等位基因频率相似，反之则说明存在差异。如果自然筛选更偏向某一类基因型的话，那么在该位点上，自然筛选后的个体和没有自然筛选的个体相比，理论上会存在差异。

**情况三**：$F_{ST}$可用作人类疾病的关联分析和法医鉴定中。假如你通过全基因组关联分析找了某个和疾病相关联的SNP，那么这个SNP的可靠性有多高呢？比如说你选择是来自于同一个群体的对照组和实验组，这个群体从理论上讲是经历了相同的演化过程，如果选择的两个组在这个位点上$F_{ST}$不存在差异，这说明这个位点被找到可能仅仅是偶尔因素，自然演化中对这个位点没有偏好性。

#### $F_{ST}$的推导

参考资料：

- Genetics in geographically structured populations: defining, estimating and interpreting FST
- <http://www.uwyo.edu/dbmcd/molmark/lect05/lect5.html>


通过高通量测序拿到了大量样本的SNP信息后，下一步该怎么办？不妨看看这张<http://www.molecularecologist.com/>在2018年1月份的一篇文章《Molecular ecology, the flowchart》里的套路图吧

![分析套路](http://oex750gzt.bkt.clouddn.com/18-2-19/37890748.jpg)
