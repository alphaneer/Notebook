# 使用stacks构建遗传图谱

尽管目前已经有大量物种基因组释放出来，但还是存在许多物种是没有参考基因组。使用基于酶切的二代测序技术，如RAD-seq，GBS，构建遗传图谱是研究无参考物种比较常用的方法。Stacks就是目前比较通用的分析流程，能用来构建遗传图谱，处理群体遗传学，构建进化发育树。

这篇教程主要介绍如何使用Stacks分析基于酶切的二代测序结果，比如说等RAD-seq，分析步骤为原始数据质量评估， 多标记数据分离，序列比对（无参则需要进行contig _de novo_ 组装），RAD位点组装和基因分型，以及后续的标记过滤和格式转换。

适用范围：

- 酶切文库类型：ddRAD, GBS, ezRAD, quad-dRAD和Rapture。 但是stacks更适用于RAD-seq，GBS推荐TASSEL。
- 测序类型： 双酶切文库双端测序数据或单端数据
- 测序平台： illumina，  IonTorren

局限性：

- 不能用于普通的随机文库测序
- 不能适用单酶切文库的双端测序数据（stacks 2.0可以）
- 无法用于混池测序，也不适合与多倍体，因为stacks在组装时假定物种为二倍体
- 对于深度不够，且错误率比较高的数据，它也没辙，所以建议深度在20x以上

要求：掌握基本的Unix命令行，会基本集群操作，熟悉R语言编程

## 前期准备

准备分为两个部分：软件安装和数据下载。
